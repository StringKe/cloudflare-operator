---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.2
  name: tunnelgatewayclassconfigs.networking.cloudflare-operator.io
spec:
  group: networking.cloudflare-operator.io
  names:
    kind: TunnelGatewayClassConfig
    listKind: TunnelGatewayClassConfigList
    plural: tunnelgatewayclassconfigs
    shortNames:
    - tgcc
    singular: tunnelgatewayclassconfig
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.tunnelRef.name
      name: Tunnel
      type: string
    - jsonPath: .spec.tunnelRef.kind
      name: Kind
      type: string
    - jsonPath: .spec.dnsManagement
      name: DNS
      type: string
    - jsonPath: .status.gatewayCount
      name: Gateways
      type: integer
    - jsonPath: .status.routeCount
      name: Routes
      type: integer
    - jsonPath: .status.state
      name: State
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha2
    schema:
      openAPIV3Schema:
        description: "TunnelGatewayClassConfig provides GatewayClass parameters for
          Cloudflare Tunnel Gateway Controller.\nThis resource links a GatewayClass
          to a specific Tunnel or ClusterTunnel and configures\nhow the Gateway Controller
          handles DNS records and origin connections.\n\nExample usage:\n\n\tapiVersion:
          networking.cloudflare-operator.io/v1alpha2\n\tkind: TunnelGatewayClassConfig\n\tmetadata:\n\t
          \ name: cloudflare-tunnel\n\tspec:\n\t  tunnelRef:\n\t    kind: ClusterTunnel\n\t
          \   name: production-tunnel\n\t  dnsManagement: Automatic\n\t  dnsProxied:
          true"
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: TunnelGatewayClassConfigSpec defines the desired state of
              TunnelGatewayClassConfig
            properties:
              defaultOriginRequest:
                description: |-
                  DefaultOriginRequest provides default origin request settings for all Routes
                  using this GatewayClass. Can be overridden per-Route via annotations.
                properties:
                  bastionMode:
                    description: BastionMode enables bastion mode for the tunnel
                    type: boolean
                  caPool:
                    description: CAPool is the name of a Secret containing CA certificate
                      (tls.crt) for backend verification
                    type: string
                  connectTimeout:
                    description: ConnectTimeout for establishing connection to origin
                      (e.g., "30s")
                    type: string
                  disableChunkedEncoding:
                    description: DisableChunkedEncoding disables chunked transfer
                      encoding for HTTP requests
                    type: boolean
                  http2Origin:
                    default: false
                    description: HTTP2Origin enables HTTP/2 to origin (origin must
                      be HTTPS)
                    type: boolean
                  httpHostHeader:
                    description: HTTPHostHeader overrides the Host header sent to
                      origin
                    type: string
                  keepAliveConnections:
                    description: KeepAliveConnections is the maximum number of idle
                      connections to keep open
                    minimum: 0
                    type: integer
                  keepAliveTimeout:
                    description: KeepAliveTimeout for idle connections to origin (e.g.,
                      "90s")
                    type: string
                  noTlsVerify:
                    default: false
                    description: NoTLSVerify disables TLS verification for HTTPS origins
                    type: boolean
                  originServerName:
                    description: OriginServerName overrides the hostname used for
                      TLS verification
                    type: string
                  proxyAddress:
                    description: ProxyAddress for bastion/SOCKS mode
                    type: string
                  proxyPort:
                    description: ProxyPort for bastion/SOCKS mode
                    maximum: 65535
                    minimum: 1
                    type: integer
                  proxyType:
                    description: 'ProxyType specifies the proxy type: "" (none) or
                      "socks"'
                    enum:
                    - ""
                    - socks
                    type: string
                  tlsTimeout:
                    description: TLSTimeout for TLS handshake with origin (e.g., "10s")
                    type: string
                type: object
              dnsManagement:
                default: Automatic
                description: |-
                  DNSManagement controls how DNS records are managed for Route hostnames.
                  - Automatic: Controller creates CNAME records directly via Cloudflare API
                  - Manual: User manages DNS records externally (compatible with external-dns)
                  - DNSRecord: Controller creates DNSRecord CRDs for each hostname
                enum:
                - Automatic
                - Manual
                - DNSRecord
                type: string
              dnsProxied:
                default: true
                description: |-
                  DNSProxied controls whether DNS records are proxied through Cloudflare.
                  Only applies when DNSManagement is Automatic or DNSRecord.
                type: boolean
              fallbackTarget:
                default: http_status:404
                description: |-
                  FallbackTarget is the default target for unmatched requests.
                  Defaults to "http_status:404" if not specified.
                type: string
              tunnelRef:
                description: TunnelRef references the Tunnel or ClusterTunnel to use
                  for this GatewayClass
                properties:
                  kind:
                    description: 'Kind is the tunnel resource kind: Tunnel or ClusterTunnel'
                    enum:
                    - Tunnel
                    - ClusterTunnel
                    type: string
                  name:
                    description: Name is the name of the Tunnel/ClusterTunnel resource
                    type: string
                  namespace:
                    description: |-
                      Namespace is the namespace of the Tunnel (only for Kind=Tunnel).
                      If not specified for Kind=Tunnel, defaults to the TunnelIngressClassConfig's namespace.
                    type: string
                required:
                - kind
                - name
                type: object
              watchNamespaces:
                description: |-
                  WatchNamespaces limits which namespaces the controller watches for Routes.
                  If empty, watches all namespaces.
                items:
                  type: string
                type: array
            required:
            - tunnelRef
            type: object
          status:
            description: TunnelGatewayClassConfigStatus defines the observed state
              of TunnelGatewayClassConfig
            properties:
              conditions:
                description: Conditions represent the latest available observations
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              gatewayCount:
                description: GatewayCount is the number of Gateways using this configuration
                type: integer
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed
                format: int64
                type: integer
              routeCount:
                description: RouteCount is the total number of Routes across all Gateways
                type: integer
              state:
                description: State represents the current state of the configuration
                enum:
                - pending
                - active
                - error
                type: string
              tunnelId:
                description: TunnelID is the resolved Cloudflare Tunnel ID
                type: string
              tunnelName:
                description: TunnelName is the resolved Cloudflare Tunnel name
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
